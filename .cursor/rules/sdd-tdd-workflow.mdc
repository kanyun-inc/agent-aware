---
description: 【强制】SDD + TDD 开发工作流 - 所有代码变更必须遵循
alwaysApply: true
---

# SDD + TDD 工作流【强制规则】

**⚠️ 本规则为强制规则，任何代码变更都必须遵循此工作流。**

本项目使用 Spec-Driven + Test-Driven 开发流程。

## 核心原则【必须遵守】

- **Spec 是逻辑抽象**：`specs/` 目录包含系统行为契约，**所有需求变更必须先体现在 Spec**
- **TDD 是实现方法**：实现阶段**必须**遵循 Red → Green → Refactor 循环
- **没有 Spec 不写代码，没有测试不写实现**

## 工作流程【必须按顺序执行】

### 新功能开发

```
1. 【必须】检查 specs/ 是否有相关 Spec
   ↓
2. 【必须】创建/更新 Spec（描述行为契约）
   ↓
3. 【必须】从 Spec 的「测试要点」拆解测试用例
   ↓
4. 【必须】写失败测试 → 实现代码 → 测试通过 → 重构
   ↓
5. 【必须】更新 Spec 状态为 accepted
```

### Bug 修复【必须遵循】

```
1. 【必须】分析 Bug 根因
   ↓
2. 【必须】检查是否 Spec 遗漏或错误 → 更新 Spec
   ↓
3. 【必须】写失败测试复现 Bug（没有复现测试不允许修复！）
   ↓
4. 【必须】修复代码 → 测试变绿
   ↓
5. 【必须】更新 Spec 变更记录
```

## Spec 文件位置

```
specs/
├── README.md           # 索引
├── sdk/                # SDK 相关 Spec
└── server/             # Server 相关 Spec
```

## 操作指引【严格执行】

当用户提出需求或报告 Bug 时，**必须按以下顺序执行**：

1. **先问**：这个改动涉及哪个模块的 Spec？
2. **先读**：查看对应的 Spec 文件
3. **先改 Spec**：在 Spec 中描述期望行为
4. **再写测试**：基于 Spec 写测试用例
5. **最后实现**：让测试通过

**禁止跳过任何步骤。**

## 禁止事项【违反即停止】

- 🚫 **禁止**跳过 Spec 直接写代码
- 🚫 **禁止**跳过测试直接实现
- 🚫 **禁止** Bug 修复时不写复现测试
- 🚫 **禁止**在 Spec 未更新的情况下修改行为

如果用户要求跳过流程，必须提醒用户本项目的强制规则，并建议遵循流程。
